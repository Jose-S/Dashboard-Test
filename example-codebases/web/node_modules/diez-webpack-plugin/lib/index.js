"use strict";const t=require("fs"),s=require("path"),i=require("webpack");module.exports=class{constructor(t){this.options=t}validateOptions(){if(!this.options.sdk)throw new Error("DiezWebpackPlugin: an `sdk` option is required.");if(!this.options.projectPath){let t;try{t=require.resolve(this.options.sdk)}catch(t){throw new Error(`DiezWebpackPlugin: unable to resolve a Diez web SDK from the provided sdk option. Please ensure '${this.options.sdk}' is installed.`)}this.options.projectPath=s.resolve(s.dirname(t),"..","..")}t.existsSync(this.options.projectPath)||console.warn("DiezWebpackPlugin: unable to determine the location of your Diez project. Note that hot mode will not work unless you provide an explicit path via 'projectPath'.")}get hotFilePath(){return s.join(this.options.projectPath,".diez","web-hot-url")}get isRunningHot(){return t.existsSync(this.hotFilePath)}setAlias(t){t.options.resolve=t.options.resolve||{},t.options.resolve.alias=t.options.resolve.alias||{},t.options.resolve.alias["@diez/styles.scss"]=this.isRunningHot?s.join(this.options.projectPath,".diez","web-assets","styles.scss"):s.join(this.options.projectPath,"build",`${this.options.sdk}-web`,"static","styles.scss")}setEnvironmentVariables(s){if(this.isRunningHot){const e=t.readFileSync(this.hotFilePath).toString().trim();console.warn(`Enabling hot mode with URL: ${e}`),s.options.plugins=s.options.plugins||[],s.options.plugins.push(new i.DefinePlugin({"process.env.DIEZ_IS_HOT":JSON.stringify(!0),"process.env.DIEZ_SERVER_URL":JSON.stringify(e)}))}}apply(t){this.validateOptions(),this.setAlias(t),this.setEnvironmentVariables(t)}};
//# sourceMappingURL=/@diez/diez-webpack-plugin/lib/index.js.map